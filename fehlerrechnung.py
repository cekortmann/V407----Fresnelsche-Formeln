import matplotlib.pyplot as plt
import matplotlib as mpl
import numpy as np
from numpy import sqrt
import scipy.constants as const
from scipy.optimize import curve_fit                        # Funktionsfit:     popt, pcov = curve_fit(func, xdata, ydata) 
from uncertainties import ufloat                            # Fehler:           fehlerwert =  ulfaot(x, err)
from uncertainties import unumpy as unp 
from uncertainties.unumpy import uarray                     # Array von Fehler: fehlerarray =  uarray(array, errarray)
from uncertainties.unumpy import (nominal_values as noms,   # Wert:             noms(fehlerwert) = x
                                  std_devs as stds)  

def n(a, I, E):
    return np.sqrt(0.5*((E+E*np.sqrt(140/I))/(E-E*np.sqrt(140/I))*1/np.cos(a))**2+np.sqrt(0.25*((E+E*np.sqrt(140/I))/(E-E*np.sqrt(140/I))*1/np.cos(a))**4-(E+E*np.sqrt(140/I))/(E-E*np.sqrt(140/I))**2*(np.tan(a))**2))

ua =[6,
8,
10,
12,
14,
16,
18,
20,
22,
24,
26,
28,
30,
32,
34,
36,
38,
40,
42,
44,
46,
48,
50,
52,
54,
56,
58,
60,
62,
64,
66,
68,
70,
72,
74,
76,
78,
80,
82,
84,
86]

uI = [54,
54,
54,
53,
52,
50,
50,
50,
49,
48,
45,
44,
44,
43,
41,
37,
39,
38,
36,
34,
32,
30,
29,
26,
22,
22,
20,
17,
14,
10,
8,
6.7,
4.6,
2.5,
1.4,
1,
2,
5.2,
12,
22,
46]

uE =[0.621059003,
0.621059003,
0.621059003,
0.615281585,
0.6094494,
0.597614305,
0.597614305,
0.597614305,
0.591607978,
0.585540044,
0.56694671,
0.560611911,
0.560611911,
0.554204707,
0.541162769,
0.514087263,
0.527798663,
0.520988072,
0.507092553,
0.49280538,
0.478091444,
0.46291005,
0.455129495,
0.430945804,
0.396412484,
0.396412484,
0.377964473,
0.348466026,
0.316227766,
0.267261242,
0.239045722,
0.218762755,
0.181265393,
0.133630621,
0.1,
0.084515425,
0.119522861,
0.192724822,
0.292770022,
0.396412484,
0.573211504]

b1=[0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0]

i=0
while i<41:
    b1[i]+= n(ua[i],uI[i],uE[i])
    i+=1
print(b1)